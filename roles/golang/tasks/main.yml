- name: Install requirements
  ansible.builtin.apt: pkg=curl,ca-certificates
  become: yes

- name: get golang
  ansible.builtin.unarchive:
    src: "https://golang.org/dl/go1.16.3.linux-{% if ansible_architecture == 'aarch64' %}arm64{% else %}amd64{% endif %}.tar.gz"
    dest: /usr/local
    creates: /usr/local/go
    owner: root
    remote_src: yes
  become: yes

- name: Create a directory if it does not exist
  ansible.builtin.file:
    path: $HOME/go
    state: directory

- name: Update ~/.profile
  ansible.builtin.blockinfile:
    create: yes
    path: ~/.profile
    block: |
      export GOPATH=$HOME/go
      export PATH=$PATH:/usr/local/go/bin:$GOPATH/bin
